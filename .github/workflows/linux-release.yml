##
## Create a release archive for Linux.
##
name: Linux Release
on: [push]
jobs:
  create-release:
    runs-on: ubuntu-18.04
    steps:
      - name: Checkout source code
        uses: actions/checkout@v2

      - name: Install minimal Rust build system
        uses: actions-rs/toolchain@v1
        with:
          toolchain: 1.44.1
          default: true

      - name: Build software
        run: make release

      - name: Create release archives
        run: |
           rm -rf /tmp/inst
           make DESTDIR=/tmp/inst install
           cd /tmp/inst
           tar zcf /tmp/mdcat.tar.gz .
           zip -r /tmp/mdcat.zip .

      - name: Upload Release Archives
        uses: actions/upload-artifact@v2
        with:
          name: Archives for Ubuntu 18.04
          path: |
            /tmp/mdcat.tar.gz
            /tmp/mdcat.zip
          retention-days: 3
